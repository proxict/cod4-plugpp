#include <boost/ut.hpp>
#include <cod4-plugpp/utils/arithmetic.hpp>

using namespace boost::ut;
namespace am = plugpp::utils::arithmetic;

template <typename TExpected>
constexpr auto parse_equals(const std::string& value_str,
                            TExpected expected,
                            const reflection::source_location& sl = reflection::source_location::current()) {
    const auto v = am::parse<TExpected>(value_str);
    if constexpr (std::is_floating_point_v<TExpected>) {
        constexpr auto EPSILON = static_cast<TExpected>(0.0000000000000001);
        return expect(v.has_value() && approx(*v, expected, EPSILON), sl);
    } else {
        return expect(v.has_value() && *v == _t(expected), sl);
    }
}

template <typename TExpected>
constexpr void parse_fails(const std::string& value_str,
                           const reflection::source_location& sl = reflection::source_location::current()) {
    expect(!am::parse<TExpected>(value_str).has_value(), sl);
}

suite<"arithmetic"> s2 = ([]() {
    "int64"_test = [] {
        parse_equals<int64_t>("-9223372036854775808", std::numeric_limits<int64_t>::min());
        parse_equals<int64_t>("-1", -1);
        parse_equals<int64_t>("0", 0);
        parse_equals<int64_t>("1", 1);
        parse_equals<int64_t>("9223372036854775807", std::numeric_limits<int64_t>::max());

        parse_fails<int64_t>("");
        parse_fails<int64_t>("abc");
        parse_fails<int64_t>("-9223372036854775809");
        parse_fails<int64_t>("9223372036854775808");
    };

    "int32"_test = [] {
        parse_equals<int32_t>("-2147483648", std::numeric_limits<int32_t>::min());
        parse_equals<int32_t>("-1", -1);
        parse_equals<int32_t>("0", 0);
        parse_equals<int32_t>("1", 1);
        parse_equals<int32_t>("2147483647", std::numeric_limits<int32_t>::max());

        parse_fails<int32_t>("");
        parse_fails<int32_t>("abc");
        parse_fails<int32_t>("-2147483649");
        parse_fails<int32_t>("2147483648");
    };

    "int16"_test = [] {
        parse_equals<int16_t>("-32768", std::numeric_limits<int16_t>::min());
        parse_equals<int16_t>("-1", -1);
        parse_equals<int16_t>("0", 0);
        parse_equals<int16_t>("1", 1);
        parse_equals<int16_t>("32767", std::numeric_limits<int16_t>::max());

        parse_fails<int16_t>("");
        parse_fails<int16_t>("abc");
        parse_fails<int16_t>("-32769");
        parse_fails<int16_t>("32768");
    };

    "int8"_test = [] {
        parse_equals<int8_t>("-128", std::numeric_limits<int8_t>::min());
        parse_equals<int8_t>("-1", -1);
        parse_equals<int8_t>("0", 0);
        parse_equals<int8_t>("1", 1);
        parse_equals<int8_t>("127", std::numeric_limits<int8_t>::max());

        parse_fails<int8_t>("");
        parse_fails<int8_t>("abc");
        parse_fails<int8_t>("-129");
        parse_fails<int8_t>("128");
    };

    // Unsigned integers
    "uint64"_test = [] {
        parse_equals<uint64_t>("0", 0);
        parse_equals<uint64_t>("1", 1);
        parse_equals<uint64_t>("18446744073709551615", std::numeric_limits<uint64_t>::max());

        parse_fails<uint64_t>("");
        parse_fails<uint64_t>("abc");
        parse_fails<uint64_t>("-1");
        parse_fails<uint64_t>("18446744073709551616");
    };

    "uint32"_test = [] {
        parse_equals<uint32_t>("0", 0);
        parse_equals<uint32_t>("1", 1);
        parse_equals<uint32_t>("4294967295", std::numeric_limits<uint32_t>::max());

        parse_fails<uint32_t>("");
        parse_fails<uint32_t>("abc");
        parse_fails<uint32_t>("-1");
        parse_fails<uint32_t>("4294967296");
    };

    "uint16"_test = [] {
        parse_equals<uint16_t>("0", 0);
        parse_equals<uint16_t>("1", 1);
        parse_equals<uint16_t>("65535", std::numeric_limits<uint16_t>::max());

        parse_fails<uint16_t>("");
        parse_fails<uint16_t>("abc");
        parse_fails<uint16_t>("-1");
        parse_fails<uint16_t>("65536");
    };

    "uint8"_test = [] {
        parse_equals<uint8_t>("0", 0);
        parse_equals<uint8_t>("1", 1);
        parse_equals<uint8_t>("255", std::numeric_limits<uint8_t>::max());

        parse_fails<uint8_t>("");
        parse_fails<uint8_t>("abc");
        parse_fails<uint8_t>("-1");
        parse_fails<uint8_t>("256");
    };

    // Floating point
    "float"_test = [] {
        parse_equals<float>("-340282346638528859811704183484516925440.0", -std::numeric_limits<float>::max());
        parse_equals<float>("340282346638528859811704183484516925440.0", std::numeric_limits<float>::max());
        parse_equals<float>("0", 0);
        parse_equals<float>("1", 1);
        parse_equals<float>("4.2e-3", 4.2e-3f);
        parse_equals<float>("-10.1e3", -10.1e3f);
        parse_equals<float>("42.", 42.f);
        parse_equals<float>("-7.", -7.f);

        parse_fails<float>("");
        parse_fails<float>("abc");
        parse_fails<float>("42..");
        parse_fails<float>("14.88.");
        parse_fails<float>("14.88.0");
        parse_fails<float>("-3402823466385288598117041834845169254400.0");
        parse_fails<float>("3402823466385288598117041834845169254400.0");
    };

    "double"_test = [] {
        parse_equals<double>(
            "-17976931348623157081452742373170435679807056752584499659891747680315726078002853876058955863276"
            "687817154045895351438246423432132688946418276846754670353751698604991057655128207624549009038932"
            "894407586850845513394230458323690322294816580855933212334827479782620414472316873817718091929988"
            "1250404026184124858368.0",
            -std::numeric_limits<double>::max());
        parse_equals<double>(
            "179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766"
            "878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328"
            "944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881"
            "250404026184124858368.0",
            std::numeric_limits<double>::max());
        parse_equals<double>("0", 0);
        parse_equals<double>("1", 1);
        parse_equals<double>("4.2e-3", 4.2e-3);
        parse_equals<double>("-10.1e3", -10.1e3);
        parse_equals<double>("42.", 42.);
        parse_equals<double>("-7.", -7.);

        parse_fails<double>("");
        parse_fails<double>("abc");
        parse_fails<double>("42..");
        parse_fails<double>("14.88.");
        parse_fails<double>("14.88.0");
        parse_fails<double>(
            "-17976931348623157081452742373170435679807056752584499659891747680315726078002853876058955863276"
            "687817154045895351438246423432132688946418276846754670353751698604991057655128207624549009038932"
            "894407586850845513394230458323690322294816580855933212334827479782620414472316873817718091929988"
            "12504040261841248583680.0");
        parse_fails<double>(
            "179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766"
            "878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328"
            "944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881"
            "2504040261841248583680.0");
    };

    "long_double"_test = [] {
        parse_equals<long double>(
            "-11897314953572317650212638530309702051690633222946242004403237338917370055229707226164102903365"
            "288828535456978074955773144274431536702884341981255738537436786735932007069732632019159182829615"
            "243655295106467910866143117906321697788388961347865606003991487534332114549111600886798451548665"
            "128523401497730376000091254793939662231513836224178385427439178381387178058894875405751682263476"
            "592355769748051137256490208848552224947913993775850260117735491800997962260268595085588836081598"
            "469002356451323465944763849398592764562845796617729304078066092291027150460853880879593277816229"
            "868275478307680800401506949423034117289577771003357140105597752421240573470073862516601108283791"
            "196230084692772009651535002084744707924438485459128867230006190851264721119513614675276335195629"
            "275979572502780029807959041931396030214709970352764674455309220226796562809914982320833296412410"
            "385092391847347861219216972105434842870483534081130425730022164213489173471742348007148807510020"
            "643905172342476560047217680964861079949434157034763206435586242074435044243805661360176088374781"
            "653890278095769759772868600714870282879555671414046326158326236027628963161739784842544868606099"
            "482708679680480787025118589308385465842230409088059962945945862019037660484467909260022254105307"
            "759010657606713472001258464069570302571389609837579989269545530523685607586831792231136395194688"
            "508807718721047052039575874800131431314442549439199401757531693393923668818561891299317291042529"
            "212368351599223220509980016771027840353601408292963981151228777681357060457893435354516965395612"
            "540488464471697868932116710872290880827783505182288576460622187397028516550837209923494833344352"
            "289847512327537266360662139022812647062340753520717240586650795182173034637826313533937067749019"
            "501978416904418247380631628285868577414325811653640402184027249133933209492194984224427304270198"
            "730445366203502623869578046820036014472919971230955300572061418669748528468561865148327159744812"
            "031219467516863793430961896151073300655524214851952017628585950910518394725028638716324941676138"
            "049963197914418702543027067584951920088379151694015817400467114778772014596444611752040594535047"
            "647218079757611117208462736392796003396704700376133745095531841500737964126050479232516613548412"
            "918842113408230154733047540670728187635036173329080059518963252070716739045477771296822652062256"
            "514399193768044002923809031124379126147762559646942219813751469670794468703580043925076594516183"
            "798118593920495440361149153107822510726914869798092409467721427270124043771874092167566136349389"
            "004512323516681460893224006979931760178053381918499819330084109859939387602926013909114145260037"
            "202848721324119554242821018312042161044674046216353369005836646065911562987647455250681450039329"
            "414041314954006776029510059622530228230036314738246810596484424413248645731374375950964161680480"
            "241293518762046681356368775328146755387988717718365128939471953350618850032676073543886733680020"
            "743878496570145760903498575712430451020387304948542567024793393228091105260415385289948492039910"
            "919461299124916332899179980943803378795220931314669461497059396641523759492858909604899161219449"
            "899863848370224866722491489246784102061833646274169695763076324802355879752452537370354338829608"
            "627534277400163334340550835370485073745448197547222289752810830208986826330202852599230841680545"
            "396879114182976299889645764827652875045628549242651652177507995162596692291149777889623566709566"
            "271384820181913483216879958636526376209782850700993372943967846398790249145142227425270063639423"
            "279984839767399871544185542015622441549266530145155046854892586202760857618371297633587612153825"
            "651296335381416639495165560002641591865548500570526114319529199188079545223946496276356301785808"
            "966922264062353828985358675959906470083856871238103295919264948462507689922584193054807636202150"
            "890221492205280698420183508405869384938154989094454619778930291135765167754062322782983140334732"
            "766039522316034228247175281818188443048809213219335508698733958612760736708666523755556758031714"
            "901084773200964243187800700087973460329062789435537435644488519071916164551411557619393996907674"
            "151564028265436640267600950875239455073415561358679330660317447209244465135323666476497354008519"
            "670407711036405381500734868917983640495706061895350050898409138268695350900667833244725787121966"
            "044152849248400418509328119089636341757398971665960007594878006191640948543387585206571165410722"
            "609962881501231443779440087493019447443307843889957018427100048083050121771235606228950762690428"
            "568000477188931580893585155938631766529480890312677470296625451108615489583950877967554641379448"
            "959605279752098748138397625785921057562844017593493241621483395653501891968113890918437957347032"
            "694063428900878058469403524534793980806742732362978871008671758025315613023560648787092598652884"
            "163509725295370911143172048877474055390540094253754241193179441751370646896438615177188498670103"
            "415325423859110896247108853858086888377772586485641459342621210866475884892600317623459607695088"
            "49149662444156604419552086811989770240.0",
            -std::numeric_limits<long double>::max());

        parse_equals<long double>(
            "118973149535723176502126385303097020516906332229462420044032373389173700552297072261641029033652"
            "888285354569780749557731442744315367028843419812557385374367867359320070697326320191591828296152"
            "436552951064679108661431179063216977883889613478656060039914875343321145491116008867984515486651"
            "285234014977303760000912547939396622315138362241783854274391783813871780588948754057516822634765"
            "923557697480511372564902088485522249479139937758502601177354918009979622602685950855888360815984"
            "690023564513234659447638493985927645628457966177293040780660922910271504608538808795932778162298"
            "682754783076808004015069494230341172895777710033571401055977524212405734700738625166011082837911"
            "962300846927720096515350020847447079244384854591288672300061908512647211195136146752763351956292"
            "759795725027800298079590419313960302147099703527646744553092202267965628099149823208332964124103"
            "850923918473478612192169721054348428704835340811304257300221642134891734717423480071488075100206"
            "439051723424765600472176809648610799494341570347632064355862420744350442438056613601760883747816"
            "538902780957697597728686007148702828795556714140463261583262360276289631617397848425448686060994"
            "827086796804807870251185893083854658422304090880599629459458620190376604844679092600222541053077"
            "590106576067134720012584640695703025713896098375799892695455305236856075868317922311363951946885"
            "088077187210470520395758748001314313144425494391994017575316933939236688185618912993172910425292"
            "123683515992232205099800167710278403536014082929639811512287776813570604578934353545169653956125"
            "404884644716978689321167108722908808277835051822885764606221873970285165508372099234948333443522"
            "898475123275372663606621390228126470623407535207172405866507951821730346378263135339370677490195"
            "019784169044182473806316282858685774143258116536404021840272491339332094921949842244273042701987"
            "304453662035026238695780468200360144729199712309553005720614186697485284685618651483271597448120"
            "312194675168637934309618961510733006555242148519520176285859509105183947250286387163249416761380"
            "499631979144187025430270675849519200883791516940158174004671147787720145964446117520405945350476"
            "472180797576111172084627363927960033967047003761337450955318415007379641260504792325166135484129"
            "188421134082301547330475406707281876350361733290800595189632520707167390454777712968226520622565"
            "143991937680440029238090311243791261477625596469422198137514696707944687035800439250765945161837"
            "981185939204954403611491531078225107269148697980924094677214272701240437718740921675661363493890"
            "045123235166814608932240069799317601780533819184998193300841098599393876029260139091141452600372"
            "028487213241195542428210183120421610446740462163533690058366460659115629876474552506814500393294"
            "140413149540067760295100596225302282300363147382468105964844244132486457313743759509641616804802"
            "412935187620466813563687753281467553879887177183651289394719533506188500326760735438867336800207"
            "438784965701457609034985757124304510203873049485425670247933932280911052604153852899484920399109"
            "194612991249163328991799809438033787952209313146694614970593966415237594928589096048991612194498"
            "998638483702248667224914892467841020618336462741696957630763248023558797524525373703543388296086"
            "275342774001633343405508353704850737454481975472222897528108302089868263302028525992308416805453"
            "968791141829762998896457648276528750456285492426516521775079951625966922911497778896235667095662"
            "713848201819134832168799586365263762097828507009933729439678463987902491451422274252700636394232"
            "799848397673998715441855420156224415492665301451550468548925862027608576183712976335876121538256"
            "512963353814166394951655600026415918655485005705261143195291991880795452239464962763563017858089"
            "669222640623538289853586759599064700838568712381032959192649484625076899225841930548076362021508"
            "902214922052806984201835084058693849381549890944546197789302911357651677540623227829831403347327"
            "660395223160342282471752818181884430488092132193355086987339586127607367086665237555567580317149"
            "010847732009642431878007000879734603290627894355374356444885190719161645514115576193939969076741"
            "515640282654366402676009508752394550734155613586793306603174472092444651353236664764973540085196"
            "704077110364053815007348689179836404957060618953500508984091382686953509006678332447257871219660"
            "441528492484004185093281190896363417573989716659600075948780061916409485433875852065711654107226"
            "099628815012314437794400874930194474433078438899570184271000480830501217712356062289507626904285"
            "680004771889315808935851559386317665294808903126774702966254511086154895839508779675546413794489"
            "596052797520987481383976257859210575628440175934932416214833956535018919681138909184379573470326"
            "940634289008780584694035245347939808067427323629788710086717580253156130235606487870925986528841"
            "635097252953709111431720488774740553905400942537542411931794417513706468964386151771884986701034"
            "153254238591108962471088538580868883777725864856414593426212108664758848926003176234596076950884"
            "9149662444156604419552086811989770240.0",
            std::numeric_limits<long double>::max());

        parse_equals<long double>("0", 0);
        parse_equals<long double>("1", 1);
        parse_equals<long double>("4.2e-3", 4.2e-3);
        parse_equals<long double>("-10.1e3", -10.1e3);
        parse_equals<long double>("42.", 42.);
        parse_equals<long double>("-7.", -7.);

        parse_fails<long double>("");
        parse_fails<long double>("abc");
        parse_fails<long double>("42..");
        parse_fails<long double>("14.88.");
        parse_fails<long double>("14.88.0");
        parse_fails<long double>(
            "-11897314953572317650212638530309702051690633222946242004403237338917370055229707226164102903365"
            "288828535456978074955773144274431536702884341981255738537436786735932007069732632019159182829615"
            "243655295106467910866143117906321697788388961347865606003991487534332114549111600886798451548665"
            "128523401497730376000091254793939662231513836224178385427439178381387178058894875405751682263476"
            "592355769748051137256490208848552224947913993775850260117735491800997962260268595085588836081598"
            "469002356451323465944763849398592764562845796617729304078066092291027150460853880879593277816229"
            "868275478307680800401506949423034117289577771003357140105597752421240573470073862516601108283791"
            "196230084692772009651535002084744707924438485459128867230006190851264721119513614675276335195629"
            "275979572502780029807959041931396030214709970352764674455309220226796562809914982320833296412410"
            "385092391847347861219216972105434842870483534081130425730022164213489173471742348007148807510020"
            "643905172342476560047217680964861079949434157034763206435586242074435044243805661360176088374781"
            "653890278095769759772868600714870282879555671414046326158326236027628963161739784842544868606099"
            "482708679680480787025118589308385465842230409088059962945945862019037660484467909260022254105307"
            "759010657606713472001258464069570302571389609837579989269545530523685607586831792231136395194688"
            "508807718721047052039575874800131431314442549439199401757531693393923668818561891299317291042529"
            "212368351599223220509980016771027840353601408292963981151228777681357060457893435354516965395612"
            "540488464471697868932116710872290880827783505182288576460622187397028516550837209923494833344352"
            "289847512327537266360662139022812647062340753520717240586650795182173034637826313533937067749019"
            "501978416904418247380631628285868577414325811653640402184027249133933209492194984224427304270198"
            "730445366203502623869578046820036014472919971230955300572061418669748528468561865148327159744812"
            "031219467516863793430961896151073300655524214851952017628585950910518394725028638716324941676138"
            "049963197914418702543027067584951920088379151694015817400467114778772014596444611752040594535047"
            "647218079757611117208462736392796003396704700376133745095531841500737964126050479232516613548412"
            "918842113408230154733047540670728187635036173329080059518963252070716739045477771296822652062256"
            "514399193768044002923809031124379126147762559646942219813751469670794468703580043925076594516183"
            "798118593920495440361149153107822510726914869798092409467721427270124043771874092167566136349389"
            "004512323516681460893224006979931760178053381918499819330084109859939387602926013909114145260037"
            "202848721324119554242821018312042161044674046216353369005836646065911562987647455250681450039329"
            "414041314954006776029510059622530228230036314738246810596484424413248645731374375950964161680480"
            "241293518762046681356368775328146755387988717718365128939471953350618850032676073543886733680020"
            "743878496570145760903498575712430451020387304948542567024793393228091105260415385289948492039910"
            "919461299124916332899179980943803378795220931314669461497059396641523759492858909604899161219449"
            "899863848370224866722491489246784102061833646274169695763076324802355879752452537370354338829608"
            "627534277400163334340550835370485073745448197547222289752810830208986826330202852599230841680545"
            "396879114182976299889645764827652875045628549242651652177507995162596692291149777889623566709566"
            "271384820181913483216879958636526376209782850700993372943967846398790249145142227425270063639423"
            "279984839767399871544185542015622441549266530145155046854892586202760857618371297633587612153825"
            "651296335381416639495165560002641591865548500570526114319529199188079545223946496276356301785808"
            "966922264062353828985358675959906470083856871238103295919264948462507689922584193054807636202150"
            "890221492205280698420183508405869384938154989094454619778930291135765167754062322782983140334732"
            "766039522316034228247175281818188443048809213219335508698733958612760736708666523755556758031714"
            "901084773200964243187800700087973460329062789435537435644488519071916164551411557619393996907674"
            "151564028265436640267600950875239455073415561358679330660317447209244465135323666476497354008519"
            "670407711036405381500734868917983640495706061895350050898409138268695350900667833244725787121966"
            "044152849248400418509328119089636341757398971665960007594878006191640948543387585206571165410722"
            "609962881501231443779440087493019447443307843889957018427100048083050121771235606228950762690428"
            "568000477188931580893585155938631766529480890312677470296625451108615489583950877967554641379448"
            "959605279752098748138397625785921057562844017593493241621483395653501891968113890918437957347032"
            "694063428900878058469403524534793980806742732362978871008671758025315613023560648787092598652884"
            "163509725295370911143172048877474055390540094253754241193179441751370646896438615177188498670103"
            "415325423859110896247108853858086888377772586485641459342621210866475884892600317623459607695088"
            "491496624441566044195520868119897702400.0");

        parse_fails<long double>(
            "118973149535723176502126385303097020516906332229462420044032373389173700552297072261641029033652"
            "888285354569780749557731442744315367028843419812557385374367867359320070697326320191591828296152"
            "436552951064679108661431179063216977883889613478656060039914875343321145491116008867984515486651"
            "285234014977303760000912547939396622315138362241783854274391783813871780588948754057516822634765"
            "923557697480511372564902088485522249479139937758502601177354918009979622602685950855888360815984"
            "690023564513234659447638493985927645628457966177293040780660922910271504608538808795932778162298"
            "682754783076808004015069494230341172895777710033571401055977524212405734700738625166011082837911"
            "962300846927720096515350020847447079244384854591288672300061908512647211195136146752763351956292"
            "759795725027800298079590419313960302147099703527646744553092202267965628099149823208332964124103"
            "850923918473478612192169721054348428704835340811304257300221642134891734717423480071488075100206"
            "439051723424765600472176809648610799494341570347632064355862420744350442438056613601760883747816"
            "538902780957697597728686007148702828795556714140463261583262360276289631617397848425448686060994"
            "827086796804807870251185893083854658422304090880599629459458620190376604844679092600222541053077"
            "590106576067134720012584640695703025713896098375799892695455305236856075868317922311363951946885"
            "088077187210470520395758748001314313144425494391994017575316933939236688185618912993172910425292"
            "123683515992232205099800167710278403536014082929639811512287776813570604578934353545169653956125"
            "404884644716978689321167108722908808277835051822885764606221873970285165508372099234948333443522"
            "898475123275372663606621390228126470623407535207172405866507951821730346378263135339370677490195"
            "019784169044182473806316282858685774143258116536404021840272491339332094921949842244273042701987"
            "304453662035026238695780468200360144729199712309553005720614186697485284685618651483271597448120"
            "312194675168637934309618961510733006555242148519520176285859509105183947250286387163249416761380"
            "499631979144187025430270675849519200883791516940158174004671147787720145964446117520405945350476"
            "472180797576111172084627363927960033967047003761337450955318415007379641260504792325166135484129"
            "188421134082301547330475406707281876350361733290800595189632520707167390454777712968226520622565"
            "143991937680440029238090311243791261477625596469422198137514696707944687035800439250765945161837"
            "981185939204954403611491531078225107269148697980924094677214272701240437718740921675661363493890"
            "045123235166814608932240069799317601780533819184998193300841098599393876029260139091141452600372"
            "028487213241195542428210183120421610446740462163533690058366460659115629876474552506814500393294"
            "140413149540067760295100596225302282300363147382468105964844244132486457313743759509641616804802"
            "412935187620466813563687753281467553879887177183651289394719533506188500326760735438867336800207"
            "438784965701457609034985757124304510203873049485425670247933932280911052604153852899484920399109"
            "194612991249163328991799809438033787952209313146694614970593966415237594928589096048991612194498"
            "998638483702248667224914892467841020618336462741696957630763248023558797524525373703543388296086"
            "275342774001633343405508353704850737454481975472222897528108302089868263302028525992308416805453"
            "968791141829762998896457648276528750456285492426516521775079951625966922911497778896235667095662"
            "713848201819134832168799586365263762097828507009933729439678463987902491451422274252700636394232"
            "799848397673998715441855420156224415492665301451550468548925862027608576183712976335876121538256"
            "512963353814166394951655600026415918655485005705261143195291991880795452239464962763563017858089"
            "669222640623538289853586759599064700838568712381032959192649484625076899225841930548076362021508"
            "902214922052806984201835084058693849381549890944546197789302911357651677540623227829831403347327"
            "660395223160342282471752818181884430488092132193355086987339586127607367086665237555567580317149"
            "010847732009642431878007000879734603290627894355374356444885190719161645514115576193939969076741"
            "515640282654366402676009508752394550734155613586793306603174472092444651353236664764973540085196"
            "704077110364053815007348689179836404957060618953500508984091382686953509006678332447257871219660"
            "441528492484004185093281190896363417573989716659600075948780061916409485433875852065711654107226"
            "099628815012314437794400874930194474433078438899570184271000480830501217712356062289507626904285"
            "680004771889315808935851559386317665294808903126774702966254511086154895839508779675546413794489"
            "596052797520987481383976257859210575628440175934932416214833956535018919681138909184379573470326"
            "940634289008780584694035245347939808067427323629788710086717580253156130235606487870925986528841"
            "635097252953709111431720488774740553905400942537542411931794417513706468964386151771884986701034"
            "153254238591108962471088538580868883777725864856414593426212108664758848926003176234596076950884"
            "91496624441566044195520868119897702400.0");
    };

    "bool"_test = [] {
        parse_equals<bool>("0", 0);
        parse_equals<bool>("1", 1);
        parse_equals<bool>("true", 1);
        parse_equals<bool>("false", 0);

        parse_fails<bool>("");
        parse_fails<bool>("abc");
        parse_fails<bool>("truefalse");
        parse_fails<bool>("atrue");
        parse_fails<bool>("bfalse");
        parse_fails<bool>("-1");
        parse_fails<bool>("2");
    };
});
